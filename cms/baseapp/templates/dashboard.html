{% extends 'base.html' %}

{% block content %}
<div class="page-header">
  <h1 class="page-title">Incident List</h1>
</div>
<div class="btn-list text-right">
</div>
<div class="col-12">
  <div class="card">
    <div class="card-header">
      <h3 class="card-title">Incidents</h3>
      <div class="card-options">
        <a href="{% url 'new_incident_form' %}" class="btn btn-outline-primary"><i class="fe fe-plus mr-2"></i>Add New
          Incident</a>
      </div>
    </div>
    <div class="table-responsive">
      <table class="table card-table table-vcenter text-nowrap">
        
        {% if incidents|length == 0 %}
        <thead>
          <tbody>
            <tr>
              <td class="text-center">No incidents =)</td>
            </tr>
          </tbody>
        </thead>
        {% else %}
        <thead>
          <tr>
            <th class="w-1">ID</th>
            <th>Area</th>
            <th>Level</th>
            <th>Incident Type</th>
            <th>Created</th>
            <th>Status</th>
            <th></th>
          </tr>
        </thead>
        {% endif %}

        {% for incident in incidents %}
        <tbody>
          <tr>
            <td><span class="text-muted text-centre">{{ incident.id }}</span></td>
            <td>{{ incident.area }}</td>
            
            {% if incident.level == 'CAT2' %}
            <td> <span class="status-icon bg-warning"></span>{{ incident.level }}</td>
            {% else %}
            <td> <span class="status-icon bg-red"></span>{{ incident.level }}</td>
            {% endif %}

            <td>{{ incident.incident_type }}</td>
            <td>
              Hardcoded
            </td>
            
            {% if incident.status == 'Reported' %}
            <td>
              <span class="status-icon bg-danger"></span> Reported
            </td>
            {% elif incident.status == 'Handling' %}
            <td>
              <span class="status-icon bg-warning"></span> Handling
            </td>
            {% endif %}
            
            <td class="text-right">
              <a href="{% url 'incident_details' incident.id %}" class="btn btn-outline-info btn">Details</a>
            </td>
          </tr>
        </tbody>
        {% endfor %}

      </table>
    </div>
  </div>
</div>
{% endblock %}